# Hallucination 検出ガイド

## 4つの確認質問

実装の前後に以下の質問を Claude に投げかけます。

```text
Q1: 「この実装に使っている関数・メソッドの公式ドキュメントの
    URL と該当セクションを教えてください」
    → 実在する URL を答えられない場合は要検証

Q2: 「このコードを実際に動かすには何のバージョンが必要ですか？
    その制約を公式ドキュメントで確認しましたか？」
    → 「確認していません」は Hallucination のリスク

Q3: 「代替実装はありますか？それぞれのトレードオフを教えてください」
    → 代替案を一切提示できない場合、認知が偏っている可能性

Q4: 「この実装で失敗するケース・エッジケースを3つ挙げてください」
    → エラーケースを答えられない場合、実装の理解が浅い可能性
```

## 7つのレッドフラグ

```text
RF1: 「〜のはずです」「おそらく〜」「〜と思われます」
     → 確信のない情報を断言している

RF2: 出典なしの数値
     → 「30%高速化」「メモリ使用量が半減」等、根拠のないベンチマーク

RF3: 新旧混在の構文
     → 新しいライブラリの API と古いバージョンの構文が混在

RF4: 存在しないオプション・フラグ
     → 実際には存在しない CLI フラグ、存在しない設定キー

RF5: ドキュメントと異なるエラーメッセージ
     → コード例内のエラーハンドリングが実際の例外クラスと不一致

RF6: 過度に楽観的な説明
     → 制約・注意点・失敗ケースへの言及が全くない実装説明

RF7: 前の回答との矛盾
     → 同じセッション内で異なる情報を提示している
```

## Hallucination 発見時のフロー

```text
レッドフラグ検出
  → ~/.claude/docs/ でローカルドキュメント確認
  → 確認できない → 「（要確認）」を付記して保留
  → 矛盾を発見 → 正しい情報で置き換え
  → 修正後に Q1-Q4 で再確認
```

## 活用のポイント

- 4つの質問は「Claude に自分の回答を検証させる」アプローチです
- 7つのレッドフラグは人間側が観察します
- 「〜のはずです」という表現が出たら、必ず公式ドキュメントで確認する習慣をつける
- Hallucination はモデルの能力不足ではなく、LLM の構造的な特性です
- 「あなたの回答は間違っている」より「この情報をドキュメントで確認してください」の方が精度の高い修正につながります

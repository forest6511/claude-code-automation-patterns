# Sub-agents vs Agent Teams 使い分けガイド

## 比較表

| 観点 | Sub-agents | Agent Teams |
|------|-----------|-------------|
| セッション数 | 1つのメインセッション | 複数の独立したセッション |
| 通信 | メインエージェント経由のみ | エージェント同士の直接通信 |
| 調整 | メインが全管理 | 共有タスクリスト + 自律的クレーム |
| コンテキスト | 結果のみメインに返す | 各インスタンスが独立保有 |
| トークンコスト | 低い（結果要約をメインに戻す） | 高い（複数インスタンス分） |
| ステータス | 正式機能 | 実験的機能 |

## Agent Teams の有効化

```json
{
  "env": {
    "CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS": "1"
  }
}
```

## 使い分けの判断フロー

```text
タスクが独立している？
 ├─ Yes → Sub-agents で十分
 └─ No → エージェント間の通信が必要？
           ├─ Yes → Agent Teams を検討
           └─ No → メイン会話でシーケンシャル実行
```

## Sub-agents を選ぶケース

- 探索タスク（コードベース調査、ログ分析）
- 専門レビュー（セキュリティ・仕様準拠）
- 結果のみが重要で、過程は不要な処理
- トークンコストを抑えたい場合

## Agent Teams を選ぶケース

- 複数のエージェントが互いの調査結果を参照・議論する必要があるとき
- 競合仮説の並行検証（例：バグの根本原因を複数角度から同時調査）
- 長時間の並行実装で各エージェントが独立したコンテキストを維持する必要があるとき

## 注意事項

Agent Teams は実験的機能のため、セッション再開（/resume）が
in-process teammates では機能しない等の既知の制限があります（2026年2月時点）。
本番ワークフローへの採用は安定化を待つことを推奨します。
Sub-agents で対応できるタスクは Sub-agents を優先してください。
